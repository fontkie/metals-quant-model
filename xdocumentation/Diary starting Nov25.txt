Diary Entry - November 4, 2025
Today we built the complete infrastructure for an adaptive regime-aware portfolio blending system for copper trading. Started with three sleeves (TrendCore, TrendImpulse, HookCore) but quickly discovered HookCore v4 was too weak (Sharpe 0.26) and had to be disabled. We constructed the entire adaptive portfolio architecture from scratch: regime detection module classifying markets into 9 regimes (volatility Ã— trend), dynamic weight blending with EMA smoothing, config-driven regime-specific weights, and full validation framework. The build revealed and fixed five critical bugs: 70% cash allocation destroying returns, HookCore being allocated 70% weight despite being disabled, YAML syntax errors, UTF-8 encoding issues, and duplicate risk_overlay sections. After hours of debugging, we successfully eliminated all cash drag and got the system running - but discovered a final critical bug where adaptive Sharpe equals static Sharpe to 15 decimal places (both 0.273), proving the regime weights aren't actually being applied to returns despite everything appearing correct in the logs.

The infrastructure is solid and nearly complete - regime detection works, weights are being assigned correctly per regime, config is clean, and we have a 2-sleeve foundation (TC + TI only). The remaining bug is isolated to the return calculation logic in portfolio.py where sleeve returns aren't being properly weighted despite the weight values being correct. Most likely cause: sleeve CSV files missing the 'ret' column or return calculation skipping the weight multiplication. Once this final bug is fixed (estimated 30-60 minutes), the system should immediately show the adaptive edge with Sharpe jumping to 0.35-0.45 range. Path forward: debug return calculation, then optimize regime weights for 0.45-0.55 target, add HookCore v5 (after fixing with shorts + regime filter) for 0.65-0.70, and finally build ChopCore for the 0.75-0.85 world-class target. Strong foundation built today - just one bug away from a working adaptive system.